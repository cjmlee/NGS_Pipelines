[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to Foo Lab / Dry Lab Computation",
    "section": "",
    "text": "For access to Foo-Lab network drive, please inform Mick Lee (mick.lee@u.nus.edu), or Erielle (emfv-09@nus.edu.sg) to add you into the Foo-Lab list of members / Administrators."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This webpage is for the documentation of dry lab computation and softwares in NUS Foo-Lab @ CVRI\nVisit us at:\nFoo lab webpage : foo-lab.sg\ngithub website : https://github.com/Foo-Lab\nFor any further queries :\n\nFoo-Lab Manager:\nLouis Gan (louis.gan@nus.edu.sg)\nAdministrators:\nMick Lee (mick.lee@u.nus.edu)\nErielle (emfv-09@nus.edu.sg)\nNicholas Li (nyl12@nus.edu.sg)"
  },
  {
    "objectID": "rnaseq.html",
    "href": "rnaseq.html",
    "title": "Rnaseq pipeline",
    "section": "",
    "text": "Source files can be accessible at https://github.com/cjmlee/wilsonNGS/tree/master/RNAseq\nThis pipeline will take in paired-end FASTQ files, and produce gene count as output.\nThis is a general outline of the Bulk RNA-sequencing Analysis"
  },
  {
    "objectID": "rnaseq.html#trimming-of-adaptors-and-base-quality",
    "href": "rnaseq.html#trimming-of-adaptors-and-base-quality",
    "title": "Rnaseq pipeline",
    "section": "Trimming of adaptors and base quality",
    "text": "Trimming of adaptors and base quality\n$TRIM –fastqc –gzip –length 100 –paired $FASTQ_READ1 $FASTQ_READ2"
  },
  {
    "objectID": "rnaseq.html#star-alignment",
    "href": "rnaseq.html#star-alignment",
    "title": "Rnaseq pipeline",
    "section": "STAR alignment",
    "text": "STAR alignment\n$STAR –runThreadN $THREAD –genomeDir $STARIND –readFilesCommand zcat –outFileNamePrefix RNASEQ –outSAMtype BAM Unsorted –readFilesIn $TF1 $TF2 $STAR –runThreadN $THREAD –genomeDir $STARIND –sjdbFileChrStartEnd RNASEQSJ.out.tab –readFilesCommand zcat –outFileNamePrefix RNASEQ.2Pass –outSAMtype BAM Unsorted –readFilesIn $TF1 $TF2"
  },
  {
    "objectID": "rnaseq.html#sort-the-bam-files-by-name-and-count-by-htseq-count-for-edgerdeseq-analysis",
    "href": "rnaseq.html#sort-the-bam-files-by-name-and-count-by-htseq-count-for-edgerdeseq-analysis",
    "title": "Rnaseq pipeline",
    "section": "sort the bam files by name and count by htseq-count for EdgeR/DESeq analysis",
    "text": "sort the bam files by name and count by htseq-count for EdgeR/DESeq analysis\n$SAMTOOLS sort -n rnaseqtrimmedAligned.out.bam name_rnaseqtrimmedAligned.out $HTSEQCOUNT -f bam -r name -s no -m union name_rnaseqtrimmedAligned.out.bam $GTF &gt; count.txt ```"
  },
  {
    "objectID": "index.html#mounting-foo-lab-network-drive-in-nus-on-ubuntu-and-ubuntu-wsl-systems-using-cifs-utils-smb-protocol",
    "href": "index.html#mounting-foo-lab-network-drive-in-nus-on-ubuntu-and-ubuntu-wsl-systems-using-cifs-utils-smb-protocol",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "Mounting Foo-Lab Network drive in NUS on Ubuntu and Ubuntu WSL systems using CIFs utils / SMB protocol",
    "text": "Mounting Foo-Lab Network drive in NUS on Ubuntu and Ubuntu WSL systems using CIFs utils / SMB protocol\nInstall cifs-utils on ubuntu:\nsudo apt update\nsudo apt-get install cifs-utils\nCreate a mount point in your /mnt directory:\nsudo mkdir /mnt/uss-foolab\nCreate a credentials file - in /etc/cifs-credentials using vim or nano\nsudo vi /etc/cifs-credentials\n\nusername=NUSNETID\npassword=NUSNETPW\ndomain=nusstf\n\nAllow special permissions to cifs-credentials\nsudo chmod 600 /etc/cifs-credentials\n\nedit /etc/fstab file and add the following entry\n\nvi /etc/fstab\n\n//hpcnas.nus.edu.sg/uss-foolab /mnt/uss-foolab cifs credentials=/etc/cifs-credentials 0 0\n\nCreate folder to mount network volume in /mnt and mount all volume\nsudo mkdir /mnt/uss-foolab \nsudo mount -a \n\nOtherwise try using DrvFs wsl plugin protocol :\nsudo mount -t drvfs //hpcnas.nus.edu.sg/uss-foolab /mnt/uss-foolab -o username=NUSNETID\n````"
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "Getting Started:",
    "text": "Getting Started:\nFor access to Foo-Lab network drive, please inform Mick Lee (mick.lee@u.nus.edu), or Erielle (emfv-09@nus.edu.sg) to add you into the Foo-Lab list of members / Administrators."
  },
  {
    "objectID": "index.html#mounting-foo-lab-network-drive-in-nus-on-window-network-drive-system",
    "href": "index.html#mounting-foo-lab-network-drive-in-nus-on-window-network-drive-system",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "Mounting Foo-Lab Network drive in NUS on Window network drive system",
    "text": "Mounting Foo-Lab Network drive in NUS on Window network drive system\nHead over to your PC drive folder, and Add Network Locations (Right Click):\n\nSpecifiy the location of your website as the following:\n\nFoo-Lab network drive folder will be accessible under network drive :"
  },
  {
    "objectID": "rnaseq.html#part-1-detailed-description-of-the-basic-pipeline",
    "href": "rnaseq.html#part-1-detailed-description-of-the-basic-pipeline",
    "title": "Rnaseq pipeline",
    "section": "Part 1: Detailed Description of the basic pipeline",
    "text": "Part 1: Detailed Description of the basic pipeline\n\n1. Trimming of the reads before mapping\njava -jar trimmomatic-0.39.jar PE $F1 $F2 read1.fastq.gz read1.un.fastq.gz read2.fastq.gz read2.un.fastq.gz ILLUMINACLIP:illumina.fa:2:30:10 LEADING:28 TRAILING:28 SLIDINGWINDOW:4:28 MINLEN:100\nInput files:\na. F1 = FASTQ File Read 1  \nb. F2 = FASTQ File Read 2  \nThe details on various parameters can be found here.\nThis command trim the reads:\na. base quality\nb. adaptors / index\nRunning LOG:\nUsing Medium Clipping Sequence: 'AGATCGGAAGAGCACACGTCT'  \nUsing Medium Clipping Sequence: 'CTGTCTCTTATACACATCT'  \nUsing Long Clipping Sequence: 'CTGTCTCTTATACACATCT+AGATGTGTATAAGAGACAG'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'  \nUsing Short Clipping Sequence: 'AGATCGGAAGAG'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAAC'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGA'  \nUsing Medium Clipping Sequence: 'TGGAATTCTCGGGTGCCAAGG'  \nILLUMINACLIP: Using 0 prefix pairs, 9 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences  \nQuality encoding detected as phred33  \nInput Read Pairs: 57690695 Both Surviving: 40872736 (70.85%) Forward Only Surviving: 9407255 (16.31%) Reverse Only Surviving: 1621021 (2.81%) Dropped: 5789683 (10.04%)  \nTrimmomaticPE: Completed successfully  \n\n\n2. Mapping of sequencing reads\nstar --runThreadN $THREAD --outFileNamePrefix rnaseqtrimmed --outSAMtype BAM Unsorted --genomeDir $STARIND --readFilesCommand zcat --readFilesIn read1.fastq.gz read2.fastq.gz  \nInput files:\na. read1.fastq.gz (trimmed fastq file R1)  \nb. read2.fastq.gz (trimmed fastq file R2)  \nc. $STARIND = indices required for the mapping of sequencing reads.  \nThe details on various parameters can be found here.\nRunning LOG:\nMar 13 23:10:09 ..... started STAR run  \nMar 13 23:10:10 ..... loading genome  \nMar 13 23:11:59 ..... started mapping  \nMar 14 02:11:40 ..... finished successfully  \n\n\n3. Generation of RAW gene count using htseq-count\n/mnt/software/bin/htseq-count -f bam -r name -s no -m union name_rnaseqtrimmedAligned.out.bam $GTF &gt; count.txt  \nInput files:\na. BAM file (sorted by read name / position )  \nb. GTF files  \nOutput file (you need this for most analysis)\nFilename: count.txt (gene count needed for EdgeR / DESeq)  \nFormat:  \n&lt;Gene ID&gt; &lt;unnormalized count&gt;  \nExample:\nENSMUSG00000093369.1    0  \nENSMUSG00000093370.1    3  \nENSMUSG00000093371.1    15  \nENSMUSG00000093373.1    0  \nENSMUSG00000093374.1    0  \n__no_feature    9269724  \n__ambiguous 97362  \n__too_low_aQual 0  \n__not_aligned   0  \n__alignment_not_unique  3113139  \nDescription of the last 5 lines of each files:\n__no_feature: reads (or read pairs) which could not be assigned to any feature\n__ambiguous: reads (or read pairs) which could have been assigned to more than one feature\n__too_low_aQual: reads (or read pairs) which were skipped due to the -a option\n__not_aligned: reads (or read pairs) in the SAM file without alignment\n__alignment_not_unique: reads (or read pairs) with more than one reported alignment.\nRunning LOG:\n...  \n31700000 SAM alignment record pairs processed.  \n31800000 SAM alignment record pairs processed.  \n31900000 SAM alignment record pairs processed.  \n32000000 SAM alignment record pairs processed.  \n32100000 SAM alignment record pairs processed.  \n32200000 SAM alignment record pairs processed.  \n32300000 SAM alignment record pairs processed.  \n32400000 SAM alignment record pairs processed.  \n32500000 SAM alignment record pairs processed.  \n32600000 SAM alignment record pairs processed.  \n32700000 SAM alignment record pairs processed.  \n32800000 SAM alignment record pairs processed.  \n32889607 SAM alignment pairs processed."
  },
  {
    "objectID": "rnaseq.html#part-2-running-differential-expression-analysis-using-edger-package-using-mouse-sham-vs-tac-rna-seq-as-example",
    "href": "rnaseq.html#part-2-running-differential-expression-analysis-using-edger-package-using-mouse-sham-vs-tac-rna-seq-as-example",
    "title": "Rnaseq pipeline",
    "section": "Part 2 Running Differential Expression analysis using edgeR package (using Mouse Sham vs TAC RNA-seq as example)",
    "text": "Part 2 Running Differential Expression analysis using edgeR package (using Mouse Sham vs TAC RNA-seq as example)\nThe differential analysis starts here:\nRscript-3.5.1 edgeR.r &lt;control group&gt; &lt; treatment group&gt;  \n\nInput\nInput file: countfile.txt (hard-coded for now)\nThis file is a tab-delimited text file with 3 columns. Header is optional.\n| Column | Description | | ——– | ———– | | Column 1 | full path to the count file generated by htseq-count | | Column 2 | sample id | | Column 3 | condition/grouping information used for DE analysis |\nExample countfile.txt:\n| countfile | sampleid | group | | — | — | — | | RMH3869_count.txt | RMH3869 | TAC | | RMH3871_count.txt | RMH3871 | SHAM | | RMH3872_count.txt | RMH3872 | TAC | | RMH3874_count.txt | RMH3874 | SHAM | | RMH3875_count.txt | RMH3875 | TAC | | RMH3877_count.txt | RMH3877 | SHAM |\n\n\nCommand\nI usualy run my R script on linux command line. You can also modify the script to make it work on Rstudio or any IDE.\nThe command line will require two user arguments for this particular script. These arguments are the sample groupings. In my case, it will be SHAM and TAC.\nI am using R version 3.5.1.\nRscript-3.5.1 single_edgeR.r SHAM TAC\n\n\n\nR script (You can copy this into your RStudio if you are not running on linux like me. Dont use single_edgeR.r in that case.)\nThis is the skeleton of generic edgeR analysis. You can start with this script first and slowly add/edit according to your experimental designs.\nfilelist = read.table(\"countfile.txt\")\nnames(filelist)=c(\"filename\",\"sample\",\"group\")\ngene2biotype = read.table(\"/mnt/projects/wlwtan/cardiac_epigenetics/pipeline/rnaseq_pipeline/resource/mm9/mm9_gene2biotype.txt\")  \nnames(gene2biotype)=c(\"id\",\"hgnc\",\"biotype\")  \ndata = readDGE(file=filelist$filename,group=filelist$group,labels=filelist$sample)  \ndesign = model.matrix(~0+filelist$group)  \nfilter = apply(data$counts,1,function(x) length(x[x&gt;5])&gt;=2)\nfiltered = data$counts[ filter, ]\ny = DGEList(counts = as.matrix(filtered), group=filelist$group )  \ny = calcNormFactors(y)  \ny = estimateDisp(y, design)  \nfit = glmFit(y,design)\nlrt21 = glmLRT(fit,contrast=c(-1,1))  \nk21 = as.data.frame(topTags(lrt21,n=10000000))  \nk21$hgnc = gene2biotype$hgnc[match(rownames(k21),gene2biotype$id)]  \nk21$biotype = gene2biotype$biotype[match(rownames(k21),gene2biotype$id)]  \nwrite.table(k21,file=\"de_SHAM_TAC.txt\",sep=\"\\t\",quote=FALSE)  \n\n\nOutput of single_edgeR.r\nThe R script will generate a few output files.\n\nde_SHAM_TAC.txt\nThis is the output of differential gene expression test performed by edgeR. Although there is no definite cut-off to define significance, I use abs(log2FC)&gt;0.5, FDR&lt;0.05 and avg FPKM&gt;1 as a cut-off for significant DEGs. The columns are:\n\n\n\n\nColumn\nDescription\n\n\n\n\n1\nGENCODE Gene ID\n\n\n2\nlog2FC (Group2/Group1)\n\n\n3\nlogCPM across the samples\n\n\n4\nTest statistics (loglikelihodd)\n\n\n5\nP-value\n\n\n6\nFDR\n\n\n7\nGene Symbol / HGNC\n\n\n8\nBiotype\n\n\n9-whatever\nFPKM of all samples\n\n\n\n\nScatterplot (scatterplot_withtext_SHAM_TAC.png)\nOne of the plots that we can look at is scatterplot that represents the correlation between the two conditions (SHAM and TAC). The x-axis in the graph below shows average FPKM of SHAM cardiomyocytes and the y-axis shows average FPKM of TAC cardiomyocytes.\nUnsupervised clustering based on DEGs\n\nPCA analysis based on DEGs"
  },
  {
    "objectID": "rnaseq.html#part-3-pathway-enrichment-analysis",
    "href": "rnaseq.html#part-3-pathway-enrichment-analysis",
    "title": "Rnaseq pipeline",
    "section": "Part 3: Pathway Enrichment Analysis",
    "text": "Part 3: Pathway Enrichment Analysis\n\n1. Gene-set Enrichment Analysis (GSEA)\nRscript-3.5.1 fgsea.r de_SHAM_TAC.txt\nThe analysis was done by using FGSEA R package.\nGSEA analysis takes the logFC / test statistics / pvalue from all the genes in the dataset, and try to find the pathways which are differentially expressed collectively.\nUpregulated Pathways:\n\n\n\n\n\n\n\n\n\n\npathway\npval\npadj\nES\nNES\n\n\n\n\nGO_COLLAGEN_TRIMER\n0\n0.0079\n0.8466\n2.682\n\n\nGO_EXTRACELLULAR_MATRIX_COMPONENT\n0\n0.0079\n0.7538\n2.6497\n\n\nGO_PROTEINACEOUS_EXTRACELLULAR_MATRIX\n0\n0.0079\n0.7161\n2.6478\n\n\nGO_EXTRACELLULAR_STRUCTURE_ORGANIZATION\n0\n0.0079\n0.7128\n2.6383\n\n\nGO_EXTRACELLULAR_MATRIX_BINDING\n0\n0.0079\n0.8044\n2.6162\n\n\nGO_EXTRACELLULAR_MATRIX_STRUCTURAL_CONSTITUENT\n0\n0.0079\n0.8255\n2.6064\n\n\nGO_EXTRACELLULAR_MATRIX\n0\n0.0079\n0.6939\n2.6011\n\n\nGO_BASEMENT_MEMBRANE\n0\n0.0079\n0.7501\n2.5799\n\n\nGO_COLLAGEN_BINDING\n0\n0.0079\n0.7807\n2.564\n\n\n\nDownregulated Pathways:\n\n\n\n\n\n\n\n\n\n\npathway\npval\npadj\nES\nNES\n\n\n\n\nGO_MITOCHONDRIAL_ATP_SYNTHESIS_COUPLED_PROTON_TRANSPORT\n0\n0.0143\n-0.7478\n-2.3421\n\n\nGO_PROTON_TRANSPORTING_ATP_SYNTHASE_COMPLEX\n0\n0.0148\n-0.6904\n-2.2669\n\n\nGO_BRANCHED_CHAIN_AMINO_ACID_METABOLIC_PROCESS\n0\n0.0148\n-0.6333\n-2.0795\n\n\nGO_PHOTORECEPTOR_CELL_MAINTENANCE\n0\n0.016\n-0.5669\n-1.9882\n\n\nGO_MALE_MEIOSIS\n0\n0.016\n-0.5459\n-1.9145\n\n\nGO_NADH_DEHYDROGENASE_ACTIVITY\n0\n0.0172\n-0.6156\n-2.2153\n\n\nGO_MITOCHONDRIAL_ELECTRON_TRANSPORT_NADH_TO_UBIQUINONE\n0\n0.0179\n-0.6089\n-2.2264\n\n\nGO_NADH_DEHYDROGENASE_COMPLEX\n0\n0.0179\n-0.5823\n-2.1291\n\n\nGO_FATTY_ACID_BETA_OXIDATION\n0\n0.0183\n-0.4836\n-1.8241\n\n\n\n \n\n\n2. Over-representation Analysis (Enrichment-based) Pathway analysis\nRscript-3.5.1 goseq.r de_SHAM_TAC.txt  \nThe list of differentially expressed genes will be supplied to check for enrichment in a specific geneset or pathway or ontology. The package used here is GOseq. Alternatively, there are also a couple of online free tools that you can use such as David / Enrichr.\nOntology terms enriched in up-regulated genes:\n\n\n\n\n\n\n\n\n\n\n\ncategory\nover_represented_pvalue\nnumDEInCat\nnumInCat\nterm\nontology\n\n\n\n\nGO_0030198\n1.59289631513099e-29\n58\n165\nextracellular matrix organization\nBP\n\n\nGO_0043062\n7.25401577545077e-28\n61\n198\nextracellular structure organization\nBP\n\n\nGO_0007155\n7.52728027032633e-28\n130\n786\ncell adhesion\nBP\n\n\nGO_0022610\n1.89458381420028e-27\n130\n794\nbiological adhesion\nBP\n\n\nGO_0009653\n1.3895959294514e-21\n202\n1808\nanatomical structure morphogenesis\nBP\n\n\nGO_0016477\n4.586619274943e-19\n127\n959\ncell migration\nBP\n\n\nGO_0001525\n4.8894400795615e-19\n72\n391\nangiogenesis\nBP\n\n\nGO_0035295\n5.83669120066987e-19\n112\n791\ntube development\nBP\n\n\nGO_0035239\n9.56339723145197e-19\n99\n657\ntube morphogenesis\nBP\n\n\nGO_0048870\n1.80505175084392e-18\n130\n1017\ncell motility\nBP\n\n\n\nOntology terms enriched in down-regulated genes:\n\n\n\n\n\n\n\n\n\n\n\ncategory\nover_represented_pvalue\nnumDEInCat\nnumInCat\nterm\nontology\n\n\n\n\nGO_0044281\n3.98227858592603e-08\n71\n1325\nsmall molecule metabolic process\nBP\n\n\nGO_0006635\n3.60003697030415e-07\n11\n58\nfatty acid beta-oxidation\nBP\n\n\nGO_0016054\n9.25408023716837e-07\n17\n154\norganic acid catabolic process\nBP\n\n\nGO_0046395\n9.25408023716837e-07\n17\n154\ncarboxylic acid catabolic process\nBP\n\n\nGO_0009062\n1.15898676473624e-06\n12\n78\nfatty acid catabolic process\nBP\n\n\nGO_0008016\n1.25401426261223e-06\n16\n137\nregulation of heart contraction\nBP\n\n\nGO_0043436\n2.97533226290676e-06\n40\n668\noxoacid metabolic process\nBP\n\n\nGO_0006082\n3.93851000867858e-06\n40\n676\norganic acid metabolic process\nBP\n\n\nGO_0044242\n4.12629854308222e-06\n15\n136\ncellular lipid catabolic process\nBP\n\n\nGO_0072329\n4.19219279151121e-06\n12\n88\nmonocarboxylic acid catabolic process\nBP"
  },
  {
    "objectID": "limma.html",
    "href": "limma.html",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "",
    "text": "This page is to document an example of running mass-spectrometry (Non RNA-seq data) using the LIMMA R package. For more information, please refer to the user guide: https://bioconductor.org/packages/devel/bioc/vignettes/limma/inst/doc/usersguide.pdf"
  },
  {
    "objectID": "limma.html#getting-started",
    "href": "limma.html#getting-started",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Getting Started:",
    "text": "Getting Started:\nBelow is an example run for two sample analysis (Three biological replicates)\n\n###Install packages###\nrequire(ggplot2)\n\nLoading required package: ggplot2\n\n\nWarning: package 'ggplot2' was built under R version 4.3.3\n\nrequire(gplots)\n\nLoading required package: gplots\n\n\nWarning: package 'gplots' was built under R version 4.3.3\n\n\n\nAttaching package: 'gplots'\n\n\nThe following object is masked from 'package:stats':\n\n    lowess\n\nrequire(RColorBrewer)\n\nLoading required package: RColorBrewer\n\nrequire(scales)\n\nLoading required package: scales\n\n\nWarning: package 'scales' was built under R version 4.3.2\n\nrequire(limma)\n\nLoading required package: limma\n\nrequire(qvalue)\n\nLoading required package: qvalue\n\nrm(list = ls())\n\n###Set Directory###\nsetwd(\"C:/Users/Mick Lee/Desktop/smart_nus\")\n\n##set metadata##\nfilelist &lt;- data.frame(\n  sample = c(\"D37_CN1\", \"D37_CN2\", \"D37_CN3\", \"NASH1\", \"NASH2\", \"NASH3\"),\n  group = c(\"D37\", \"D37\", \"D37\", \"NASH\", \"NASH\", \"NASH\"),\n  colour = c(\"blue\", \"blue\", \"blue\", \"red\", \"red\", \"red\")\n)\nprint(filelist)\n\n   sample group colour\n1 D37_CN1   D37   blue\n2 D37_CN2   D37   blue\n3 D37_CN3   D37   blue\n4   NASH1  NASH    red\n5   NASH2  NASH    red\n6   NASH3  NASH    red\n\n##Example of the Mass-spec data (Relative AUC from Peaks measured)##\nms&lt;-read.table(\"nash_ms.txt\", header=TRUE)\nhead(ms)\n\n           D37_CN1  D37_CN2  D37_CN3    NASH1    NASH2    NASH3\nD          1221.72   924.08   782.72   362.94   513.60   636.60\nY          1790.96  1687.30  1583.71  1218.79  1497.24  1497.12\nnm5U/hm5C     9.48     8.56     9.14     4.66     6.45     8.43\nncm5U       265.25   199.22   184.72    84.13   123.59   151.59\nm3C/m4C   29431.54 22435.62 18914.20 10138.84 13191.44 17020.13\nacp3U      1130.82   857.09   756.30   314.65   437.89   581.46"
  },
  {
    "objectID": "limma.html#perform-transformation-and-normalization",
    "href": "limma.html#perform-transformation-and-normalization",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Perform transformation and normalization",
    "text": "Perform transformation and normalization\nPerform Log normalization with small offset, 4.08 is used because at 10% quantile - valued at 4.08\n\n#log normalization\nms&lt;-log2(ms+4.08)\n#FOR NASH group\n###At 10% quantile 4.08 stabilizes the variance ###\nquantile(ms[ms&gt;0], 0.1)\n\n     10% \n4.393376"
  },
  {
    "objectID": "limma.html#define-groups-and-design-matrix-differential-testing",
    "href": "limma.html#define-groups-and-design-matrix-differential-testing",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Define groups and Design matrix + Differential Testing",
    "text": "Define groups and Design matrix + Differential Testing\nDefine groups (in this case D37 vs NASH), design matrix, and fit contrasts between two groups for differential testing between two groups & fitting linear regression using limma\n\n# Define the sample groups\ngroup &lt;- factor(c(rep(\"D37\", 3), rep(\"NASH\", 3)))\n\n# Create the design matrix\ndesign &lt;- model.matrix(~0 + group)\n\n# Define contrasts (comparing NASH with D37)\ncontrast.matrix &lt;- makeContrasts(\n  NASHvsD37 = groupNASH - groupD37,\n  levels = design\n)\n\n# Perform differential expression analysis using limma\nfit &lt;- lmFit(ms, design)\nfit &lt;- contrasts.fit(fit, contrast.matrix)\nfit &lt;- eBayes(fit)\nfit2&lt;- eBayes(fit, trend=TRUE)\n\nplotSA(fit2)\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe above variance plot which show stabilization of the variances nicely as seen from the horizontal trendline from plotSA()"
  },
  {
    "objectID": "limma.html#extract-summarize-the-results-and-bind-data",
    "href": "limma.html#extract-summarize-the-results-and-bind-data",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Extract, summarize the results and bind data",
    "text": "Extract, summarize the results and bind data\n\n# Extract and summarize the results\nresult&lt;-topTable(fit, coef = \"NASHvsD37\", number = nrow(ms))\n\n#merge result with ms\n\nNASHvsD37&lt;-cbind(ms,result)\nNASHvsD37$sig=NASHvsD37$adj.P.Val&lt;0.05 & abs(NASHvsD37$logFC)&gt;=0.5\nhead(NASHvsD37)\n\n            D37_CN1   D37_CN2   D37_CN3     NASH1     NASH2     NASH3\nD         10.259508  9.858230  9.619853  8.519715  9.015917  9.323460\nY         10.809800 10.723985 10.632804 10.256055 10.552016 10.551900\nnm5U/hm5C  3.761285  3.659925  3.724650  3.127633  3.396434  3.645010\nncm5U      8.073231  7.667466  7.560715  6.462870  6.996276  7.282347\nm3C/m4C   14.845275 14.453766 14.207493 13.308185 13.687761 14.055300\nacp3U     10.148349  9.750154  9.570577  8.316191  8.787805  9.193624\n               logFC   AveExpr         t      P.Value  adj.P.Val           B\nD         -0.8571348  5.872273 -6.219797 0.0009232637 0.03400817 -0.09443835\nY         -0.8874173  3.353315 -5.268807 0.0021218989 0.03400817 -0.95596946\nnm5U/hm5C -0.7374510  3.314144 -4.575174 0.0041749465 0.03400817 -1.66722135\nncm5U     -0.4247840  9.076081 -4.505190 0.0044862720 0.03400817 -1.74316386\nm3C/m4C   -1.0571536  9.294450 -4.005725 0.0076521263 0.03400817 -2.30814772\nacp3U     -0.5207529 12.134060 -3.881895 0.0087858773 0.03400817 -2.45449499\n            sig\nD          TRUE\nY          TRUE\nnm5U/hm5C  TRUE\nncm5U     FALSE\nm3C/m4C    TRUE\nacp3U      TRUE\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe logFC column is the slope of the regression line, and the AveExpr column is the average of the values for the protein row (same as rowMeans()). AveExpr can also be the y-intercept of the regression line when the predictor is mean-centered. The actual y-intercept is\nAveExpr−avg(AGE)⋅logFC . The other columns are t moderated t-statistic P.Value p-value adj.P.Val p-values adjusted with the Benjamini-Hocheberg procedure B log-odds of differential expression"
  },
  {
    "objectID": "limma.html#plot-pca",
    "href": "limma.html#plot-pca",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Plot PCA",
    "text": "Plot PCA\nplot PCA of samples to show unsupervised clustering based on sample data\n\n###Z-scale data###\n\nms2 = (ms-rowMeans(ms))/apply(ms,1,sd)\n\npca = prcomp(t(ms2),scale=TRUE,center=TRUE)\neigs &lt;- pca$sdev^2\npercentage_explained = eigs/sum(eigs)*100\npercentage_explained\n\n[1] 8.479417e+01 7.243287e+00 3.892483e+00 2.987105e+00 1.082954e+00\n[6] 3.207613e-31\n\npcadata = as.data.frame(pca$x)\npcadata$group &lt;- c(\"D37\", \"D37\", \"D37\", \"NASH\", \"NASH\", \"NASH\")\n\npcaxl = paste(\"PC1(\",format(round(percentage_explained[1],2),2),\"%)\",sep=\"\")\npcayl = paste(\"PC2(\",format(round(percentage_explained[2],2),2),\"%)\",sep=\"\")\n\nggplot(pcadata,aes(x=PC1,y=PC2, label=group))+geom_point(aes(color=group),shape=18,size=2)+theme_bw()+theme(panel.grid=element_blank())+xlab(pcaxl)+ylab(pcayl)+scale_color_manual(values=c(\"blue\",\"red\"))+geom_text(aes(label=rownames(pcadata)),hjust=0, vjust=0, size = 3)"
  },
  {
    "objectID": "limma.html#plotting-of-heatmap",
    "href": "limma.html#plotting-of-heatmap",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Plotting of Heatmap",
    "text": "Plotting of Heatmap\nExample plotting of heatmap to show relative expression levels using z-scaled transformed values\n\nhc = hclust(as.dist(1-cor(ms2,method=\"spearman\")),method=\"ward.D2\")\nhr = hclust(as.dist(1-cor(t(ms2),method=\"pearson\")),method=\"ward.D2\")\npar(mar=c(7,4,4,2)+0.1) \nheatmap.2(as.matrix(ms2),Colv=as.dendrogram(hc),Rowv=as.dendrogram(hr),scale=\"none\",breaks=c(seq(-2,2,by=0.04)),col=colorRampPalette(c(\"blue\",\"white\",\"orange\"))(100),density.info=\"none\",trace=\"none\",ColSideColors=as.character(filelist$colour), cexCol = 1.5, srtCol=45, # Add vertical grid lines\n          )"
  },
  {
    "objectID": "limma.html#plotting-of-data-using-enhancedvolcano-plot",
    "href": "limma.html#plotting-of-data-using-enhancedvolcano-plot",
    "title": "Running Differential Testing using the Limma Package on Non RNA-seq Data",
    "section": "Plotting of data using EnhancedVolcano plot",
    "text": "Plotting of data using EnhancedVolcano plot\n\nrequire(EnhancedVolcano)\n\nLoading required package: EnhancedVolcano\n\n\nLoading required package: ggrepel\n\n\nWarning: package 'ggrepel' was built under R version 4.3.2\n\nymax &lt;- max(-log10(NASHvsD37[, \"adj.P.Val\",]), na.rm = TRUE)\n\nEnhancedVolcano(\n  NASHvsD37,\n  lab = rownames(NASHvsD37),\n  x = 'logFC',\n  y = 'adj.P.Val',\n  title = \"Significant RNA Epi-Modifications\",\n  subtitle = \"NASH vs D37 CMs\",\n  xlim = c(-2, 2),  # Example xlim, adjust as needed\n  ylim = c(0, ymax + 1.0),\n  FCcutoff = 0.5,      # Example FCcutoff, adjust as needed\n  pCutoff = 0.05,    # Example pCutoff, adjust as needed\n  legendLabels = c('NS', 'Log2 Fold-change', 'P value', 'P value & Log2 Fold-change'),\n  legendPosition = 'bottom',\n  legendLabSize = 10,\n  legendIconSize = 5.0\n)\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nOne could create a new data frame for labels and use geom_label_repel to add an additional layer for labeling an example below:\nev+geom_label_repel( data = labels_df, aes(x = x, y = -log10(y), label = label), color = “black”, fill = “white”, segment.color = “black”, segment.size = 0.5, # Adjust label position as needed )\nwhere ev is your aesthetics for ggplot/volcanoplot\n\n\nSession info as follows:\nsessionInfo()\nR version 4.3.1 (2023-06-16 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 11 x64 (build 22621)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_Singapore.utf8  LC_CTYPE=English_Singapore.utf8    LC_MONETARY=English_Singapore.utf8\n[4] LC_NUMERIC=C                       LC_TIME=English_Singapore.utf8    \n\ntime zone: Asia/Singapore\ntzcode source: internal\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] qvalue_2.32.0          stringr_1.5.0          reshape_0.8.9          scales_1.2.1          \n [5] goseq_1.52.0           geneLenDataBase_1.36.0 BiasedUrn_2.0.10       RColorBrewer_1.1-3    \n [9] VennDiagram_1.7.3      futile.logger_1.4.3    gplots_3.1.3           ggplot2_3.4.2         \n[13] edgeR_3.42.4           limma_3.56.2          \n\nloaded via a namespace (and not attached):\n [1] DBI_1.1.3                   bitops_1.0-7                formatR_1.14                biomaRt_2.56.1             \n [5] rlang_1.1.1                 magrittr_2.0.3              matrixStats_1.0.0           compiler_4.3.1             \n [9] RSQLite_2.3.1               mgcv_1.8-42                 GenomicFeatures_1.52.1      reshape2_1.4.4             \n[13] png_0.1-8                   vctrs_0.6.3                 pkgconfig_2.0.3             crayon_1.5.2               \n[17] fastmap_1.1.1               dbplyr_2.3.3                XVector_0.40.0              caTools_1.18.2             \n[21] utf8_1.2.3                  Rsamtools_2.16.0            bit_4.0.5                   zlibbioc_1.46.0            \n[25] cachem_1.0.8                GenomeInfoDb_1.36.1         progress_1.2.2              blob_1.2.4                 \n[29] DelayedArray_0.26.7         BiocParallel_1.34.2         parallel_4.3.1              prettyunits_1.1.1          \n[33] R6_2.5.1                    stringi_1.7.12              rtracklayer_1.60.0          GenomicRanges_1.52.0       \n[37] Rcpp_1.0.11                 SummarizedExperiment_1.30.2 IRanges_2.34.1              splines_4.3.1              \n[41] Matrix_1.6-0                tidyselect_1.2.0            rstudioapi_0.15.0           abind_1.4-5                \n[45] yaml_2.3.7                  codetools_0.2-19            curl_5.1.0                  plyr_1.8.8                 \n[49] lattice_0.21-8              tibble_3.2.1                Biobase_2.60.0              withr_2.5.0                \n[53] KEGGREST_1.40.0             lambda.r_1.2.4              BiocFileCache_2.8.0         xml2_1.3.5                 \n[57] Biostrings_2.68.1           pillar_1.9.0                filelock_1.0.2              MatrixGenerics_1.12.3      \n[61] KernSmooth_2.23-21          stats4_4.3.1                generics_0.1.3              RCurl_1.98-1.12            \n[65] S4Vectors_0.38.1            hms_1.1.3                   munsell_0.5.0               gtools_3.9.4               \n[69] glue_1.6.2                  tools_4.3.1                 BiocIO_1.10.0               locfit_1.5-9.8             \n[73] GenomicAlignments_1.36.0    XML_3.99-0.14               AnnotationDbi_1.62.2        colorspace_2.1-0           \n[77] nlme_3.1-162                GenomeInfoDbData_1.2.10     restfulr_0.0.15             cli_3.6.1                  \n[81] rappdirs_0.3.3              futile.options_1.0.1        fansi_1.0.4                 S4Arrays_1.0.5             \n[85] dplyr_1.1.2                 gtable_0.3.3                EnhancedVolcano_1.18.0      digest_0.6.33              \n[89] BiocGenerics_0.46.0         ggrepel_0.9.3               rjson_0.2.21                memoise_2.0.1              \n[93] lifecycle_1.0.3             httr_1.4.6                  GO.db_3.17.0                bit64_4.0.5"
  },
  {
    "objectID": "index.html#rules-of-uss-foolab-network-drive",
    "href": "index.html#rules-of-uss-foolab-network-drive",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "RULES of uss-foolab network drive",
    "text": "RULES of uss-foolab network drive\nAccess the Foo-Lab Folder. DO NOT TOUCH the Data Storage folder (Containing Archival/legacy files) \nDeposit your Wet / Dry Data, Figures, and Work into your respective work folder.\n(If you did not find your name, make a new folder with your name)"
  },
  {
    "objectID": "index.html#how-to-deposit-in-house-next-generation-sequencing-data",
    "href": "index.html#how-to-deposit-in-house-next-generation-sequencing-data",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "How to Deposit In-house Next-Generation Sequencing Data",
    "text": "How to Deposit In-house Next-Generation Sequencing Data\nGo to Softwares &gt;&gt; Foo Lab Data Catalog"
  },
  {
    "objectID": "index.html#how-to-deposit-in-house-next-generation-sequencing-data-under-maintainence",
    "href": "index.html#how-to-deposit-in-house-next-generation-sequencing-data-under-maintainence",
    "title": "Welcome to Foo Lab (Dry Lab) on-boarding @ NUS CVRI",
    "section": "How to Deposit In-house Next-Generation Sequencing Data (Under maintainence)",
    "text": "How to Deposit In-house Next-Generation Sequencing Data (Under maintainence)\n\nGo to Softwares &gt;&gt; Foo Lab Data Catalog\nKey in your username (name) and password\n\n\n\nTwo things to fill up (Sample Information and Experiment Information)\nNote: Each Experiment should be linked to One Library ID (Assigned by Novogene/Macrogen/Other Sequencing Providers), and One experiment can have multiple samples\ne.g Macrogen: HNXXXXXXX or XXXXKNO-XXXX\nNovogene: X401SCXXXXXXXX-Z01-F00X\n\n\n\nFill up experiment information as detailed as possible - Like how you want people to understand. An example below\n\n\n\nKey in all the sample information within the specified experiment.\nFor every sample, key in the directory to your data - to the uss-foolab network drive\n6. Make sure your files are all there!"
  }
]